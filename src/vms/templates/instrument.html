{% extends "base.html" %}

{% block title %}Instrument Control{% endblock %}

{% block extra_head %}
<script>
function activate_instrument(name) {
    let source = document.getElementById(name);
    let target = document.getElementById("instrument-target");
    if (target.contains(source)) {
        return;
    }
    let inactives = document.getElementById("instrument-storage");
    inactives.appendChild(target.firstChild);
    target.appendChild(source);
}
</script>
{% endblock %}

{% block content %}
    <h1 class="text-6xl font-bold">Instrument Control</h1>
    <div class="hidden" id="instrument-storage">
        {% for instrument in instruments %}
            <div id="{{ instrument.id }}">
                {{ instrument }}
            </div>
        {% endfor %}
    </div>
    <form method="POST" class="mt-4">
        {{ form.hidden_tag() }}
        {% if form.errors %}
            <div class="p-4 mb-4 text-sm text-red-800 rounded-lg bg-red-50 dark:bg-gray-800 dark:text-red-400" role="alert">
                <span class="font-medium">The form has the following errors:</span>
                <ul>
                    {% for field_name, field_errors in form.errors|dictsort if field_errors %}
                        {% for error in field_errors %}
                            <li>{{ form[field_name].label }}: {{ error }}</li>
                        {% endfor %}
                    {% endfor %}
                </ul>
            </div>
        {% endif %}
        <fieldset class="grid grid-cols-5 gap-2 rounded-xl border border-black p-4 text-center m-4">
            <legend>Voltage Controls</legend>
            {% for field in form.voltage %}
                <div class="flex flex-col items-center gap-2">
                    {{ field.label(class_="text-xs font-bold block mb-2") }}
                    {{ field(range__class="vertical") }}
                </div>
            {% endfor %}
        </fieldset>
        <div class="flex flex-col items-center">
            {{ form.chain.label(class_="text-xs font-bold block mb-2") }}
            {{ form.chain(class_="mt-1 block w-full rounded-md border border-black p-1") }}
        </div>
        <div class="rounded-xl border border-black p-4 m-4">
            <div>
                I will simulate 1ABisopooh1brd1w-1100001000_1_129 and consider fragmentations into 1ABisopooh1w-1010000_7_18-str7-str7 and 1brd-1000_1_0</div>
            <div class="rounded-xl border border-black p-4 text-center m-4">
                <h3 class="font-bold">1ABisopooh1brd1w</h3>
                Vibrational temperature cluster: [[Lots of numbers here]]<br>
                Energy: -3121.159933773933<br>
                Rotational temperatures: 0.0197112; 0.0229917; 0.0591769
            </div>
            <div class="rounded-xl border border-black p-4 text-center m-4">
                <h3 class="font-bold">1ABisopooh1w</h3>
                Vibrational temperature cluster: [[Lots of numbers here]]<br>
                Energy: -3121.159933773933
                Rotational temperatures: 0.0197112; 0.0229917; 0.0591769
            </div>
            <div class="rounded-xl border border-black p-4 text-center m-4">
                <h3 class="font-bold">1brd</h3>
                Vibrational temperature cluster: [[Lots of numbers here]]<br>
                Energy: -3121.159933773933<br>
                Rotational temperatures: 0.0197112; 0.0229917; 0.0591769
            </div>
        </div>
        <div class="flex flex-row items-end justify-center-safe gap-8 w-full mt-8">
            <div class="flex flex-col items-center">
                <label class="text-xs font-bold block mb-2" for="instrument-select">Instrument</label>
                <select id="instrument-select" onchange="activate_instrument(this.value)" class="mt-1 block mt-1 block w-full rounded-md border border-black p-1">
                    <option selected value="default3000">Default 3000</option>
                    <option value="custom">Custom</option>
                </select>
            </div>
        </div>
        <div id="instrument-target">
            <fieldset class="grid grid-cols-3 gap-2 rounded-xl border border-black p-4 text-center m-4">
                <legend>Instrument Parameters</legend>
                {% for field in form.instrument %}
                    <div>{{ field.label }}</div>
                    <div>{{ field.default }}</div>
                    <div>{{ field }}</div>
                {% endfor %}
            <fieldset>
        </div>
        <fieldset class="hidden">
            <svg class="w-10 h-10 text-gray-200 dark:text-gray-600" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="currentColor" viewBox="0 0 20 18">
                <path d="M18 0H2a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V2a2 2 0 0 0-2-2Zm-5.5 4a1.5 1.5 0 1 1 0 3 1.5 1.5 0 0 1 0-3Zm4.376 10.481A1 1 0 0 1 16 15H4a1 1 0 0 1-.895-1.447l3.5-7A1 1 0 0 1 7.468 6a.965.965 0 0 1 .9.5l2.775 4.757 1.546-1.887a1 1 0 0 1 1.618.1l2.541 4a1 1 0 0 1 .028 1.011Z"/>
            </svg>
        </fieldset>
        <div class="flex flex-row items-end justify-center-safe gap-8 w-full mt-8">
            <input type="submit" value="Submit" class="font-bold px-3 py-2 border border-black bg-transparent transform hover:scale-105 cursor-pointer text-xs inline-block">
        </div>
    </form>
{% endblock %}
